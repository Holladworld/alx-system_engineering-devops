#/usr/bin/env/ bash
# This bash script displays listening ports
# That show only listening sockets

# netstat --listening --program
# or
# netstat -ltup
netstat -tuln | awk 'NR > 2 {print $4}' | while read -r line; do
    port=$(echo "$line" | awk -F ":" '{print $NF}')
    pid=$(lsof -i :$port -t)
    program=$(ps -p $pid -o comm=)

    if [ ! -z "$pid" ] && [ ! -z "$program" ]; then
        echo "Port: $port, PID: $pid, Program: $program"
    fi
done
